---
import { Icon } from "astro-icon/components";

interface Props {
    bgImage?: string;
    iconClass?: string;
    title?: string;
    content?: string;
}

const {
    bgImage = "https://w0.peakpx.com/wallpaper/1008/819/HD-wallpaper-future-building-concept-building-concept-future-abstract.jpg",
    iconClass = "fa-solid fa-house",
    title = "Adaptabilidad",
    content = "Aprender a vivir en constante cambio. Evolucionar y tropicalizarse.",
} = Astro.props as Props;
---

<script>
    import { gsap } from "gsap";
    function gallerySlider(){
        const track = document.getElementById("track");
        const nextBtn = document.getElementById("nextBtn");
        let slideIndex = 0;
        let totalSlides = 0;

        function updateSlides() {
            const perView = window.innerWidth < 1050 ? 1 : 3;
            if (track) {
                totalSlides = Math.ceil(track.children.length / perView);
                // Ajustar índice si excede
                slideIndex = Math.min(slideIndex, totalSlides - 1);
                // Aplicar posición inicial sin animación
                gsap.set(track, { xPercent: -100 * slideIndex });
            }
        }

        window.addEventListener("resize", updateSlides);
        // Inicializar
        updateSlides();

        if (nextBtn) {
            nextBtn.addEventListener("click", () => {
                slideIndex = (slideIndex + 1) % totalSlides;
                gsap.to(track, {
                    xPercent: -100 * slideIndex,
                    duration: 0.6,
                    ease: "power2.inOut",
                });
            });
        }
    }
    document.addEventListener("astro:after-swap", gallerySlider);
    gallerySlider();

</script>

<div
    class="w-full lg:w-1/3 flex-shrink-0 bg-gray-200 p-10 rounded-xl flex flex-col items-center justify-center font-[700] h-[500px] bg-pink-200 text-2xl relative overflow-hidden text-white"
>
    <div class="absolute top-0 left-0 w-full h-full">
        <div class="relative bg-black/50 h-full z-1"></div>
        <img
            class="absolute top-0 w-full h-full object-cover"
            src={bgImage}
            alt=""
        />
    </div>
    <div class="bg-white p-2 rounded-full text-2xl z-1 text-black">
        <Icon name={iconClass} />
    </div>
    <span class="z-1">{title}</span>
    <p class="text-sm text-center z-1">{content}</p>
</div>

